<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <title>todo test</title>
    <script src="todo.js"></script>
    <script src="dom-manipulation.js"></script>
</head>

<body>
    <script>
        // This assignment uses fetching from an external API, and DOM manipulation.
        // The API is https://jsonplaceholder.typicode.com/todos
        // The API returns a list of todo-entries.
        // The todo-entries have the following properties:
        // - id: number
        // - title: string
        // - completed: boolean
        // - userId: number
        //
        // Available functions:
        // - createAndAppendElement(parent, tag, attributes, children)
        // - clearBodyElement()
        // - todoList.fetchTodos()
        // - todoList.todos
        //
        // If you are unsure of something, please ask!

        // First, let's clear the body element
        clearBodyElement();

        // Then, let's fetch the todos
        todoList.fetchTodos()
            .then(todos => {

                const todo_table = document.createElement("table");
                //
                const todo_tr = document.createElement("tr");
                todo_table.appendChild(todo_tr);
                //
                const todo_th_userId = document.createElement("th");
                todo_th_userId.innerText = "userId";
                todo_tr.appendChild(todo_th_userId);
                //
                const todo_th_id = document.createElement("th");
                todo_th_id.innerText = "id";
                todo_tr.appendChild(todo_th_id);
                //
                const todo_th_title = document.createElement("th");
                todo_th_title.innerText = "title";
                todo_tr.appendChild(todo_th_title);
                //
                const todo_th_completed = document.createElement("th");
                todo_th_completed.innerText = "completed";
                todo_tr.appendChild(todo_th_completed);
                //
                document.body.appendChild(todo_table);

                // For every todo-entry, we do something
                for (const todo of todos) {

                    console.log(todo);
                    // ... Add the todo-entry to the DOM here!
                    const table_row = document.createElement("tr");
                    todo_table.appendChild(table_row);
                    //
                    const todo_td_userId = document.createElement("td");
                    todo_td_userId.innerText = todo.userId;
                    table_row.appendChild(todo_td_userId);
                    //
                    const todo_td_id = document.createElement("th");
                    todo_td_id.innerText = todo.id;
                    table_row.appendChild(todo_td_id);
                    //
                    const todo_td_title = document.createElement("th");
                    todo_td_title.innerText = todo.title;
                    table_row.appendChild(todo_td_title);
                    //
                    const todo_td_completed = document.createElement("th");
                    todo_td_completed.innerText = todo.completed;
                    table_row.appendChild(todo_td_completed);

                }
            })
            // If there is an error, we log it and set the todos to null
            .catch(error => {
                console.error("Error fetching todos:", error);
                todoList.todos = null;
            })
            .finally(() => {
                // If the todos are null, we log a message
                if (todoList.todos === null) {
                    console.log("No todos found");
                    // Add some user-friendly feedback to the DOM.
                    const feedbackElement = createAndAppendElement(document.body, "p", {
                        class: "feedback",
                        id: "feedback"
                    }, ["No todos found"]);
                }
            });

    </script>
</body>

    

</html>